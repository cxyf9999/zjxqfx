<!--classes.wxml-->
<view class="page">
  <!-- å¤´éƒ¨æ“ä½œæ  -->
  <view class="header-actions">
    <button class="btn-primary" bindtap="showAddModal">
      <text class="icon">â•</text>
      <text>æ–°å»ºç­çº§</text>
    </button>
  </view>

  <!-- ç­çº§åˆ—è¡¨ -->
  <view class="class-list">
    <view wx:if="{{classes.length > 0}}">
      <view class="list-item" wx:for="{{classes}}" wx:key="id">
        <view class="class-info" bindtap="selectClass" data-id="{{item.id}}">
          <view class="class-header">
            <text class="class-name">{{item.name}}</text>
            <view class="class-status {{item.id === currentClassId ? 'active' : ''}}">
              {{item.id === currentClassId ? 'å½“å‰ç­çº§' : ''}}
            </view>
          </view>
          <text class="class-desc">{{item.description}}</text>
          <view class="class-stats">
            <text class="stat-item">å­¦ç”Ÿ: {{item.studentCount || 0}}äºº</text>
            <text class="stat-item">ä½œä¸š: {{item.assignmentCount || 0}}ä¸ª</text>
          </view>
          <text class="class-date">åˆ›å»ºæ—¶é—´: {{item.createdAt}}</text>
        </view>
        <view class="class-actions">
          <button class="btn-secondary btn-small" bindtap="editClass" data-id="{{item.id}}" style="height: 72rpx; display: flex; box-sizing: border-box; left: 0rpx; top: 0rpx">ç¼–è¾‘</button>
          <button class="btn-danger btn-small" bindtap="deleteClass" data-id="{{item.id}}" wx:if="{{item.id !== 'default-class'}}">åˆ é™¤</button>
        </view>
      </view>
    </view>
    <view wx:else class="empty-state">
      <view class="empty-state-icon">ğŸ«</view>
      <view class="empty-state-text">æš‚æ— ç­çº§</view>
      <button class="btn-primary mt-20" bindtap="showAddModal">åˆ›å»ºç¬¬ä¸€ä¸ªç­çº§</button>
    </view>
  </view>
</view>

<!-- æ–°å»º/ç¼–è¾‘ç­çº§å¼¹çª— -->
<view class="modal" wx:if="{{showModal}}" bindtap="hideModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">{{isEdit ? 'ç¼–è¾‘ç­çº§' : 'æ–°å»ºç­çº§'}}</text>
      <text class="modal-close" bindtap="hideModal">Ã—</text>
    </view>
    <view class="modal-body">
      <form bindsubmit="handleSubmit">
        <view class="form-group">
          <label class="form-label">ç­çº§åç§°</label>
          <input class="form-input" 
                 name="name" 
                 value="{{formData.name}}" 
                 placeholder="è¯·è¾“å…¥ç­çº§åç§°"
                 bindinput="onInputChange"
                 data-field="name" />
        </view>
        <view class="form-group">
          <label class="form-label">ç­çº§æè¿°</label>
          <textarea class="form-textarea" 
                    name="description" 
                    value="{{formData.description}}" 
                    placeholder="è¯·è¾“å…¥ç­çº§æè¿°ï¼ˆå¯é€‰ï¼‰"
                    bindinput="onInputChange"
                    data-field="description"></textarea>
        </view>
        <view class="form-actions">
          <button class="btn-secondary" bindtap="hideModal">å–æ¶ˆ</button>
          <button class="btn-primary" formType="submit">{{isEdit ? 'ä¿å­˜' : 'åˆ›å»º'}}</button>
        </view>
      </form>
    </view>
  </view>
</view>
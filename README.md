# 作业批改记录系统 - 微信小程序版

## 项目简介

这是一个基于微信小程序的作业批改记录系统，从原有的Web版本迁移而来。系统支持班级管理、作业管理、学生管理和成绩记录等功能。

## 功能特性

### 已实现功能

1. **基础框架**
   - ✅ 微信小程序项目结构
   - ✅ 底部Tab导航
   - ✅ 数据存储工具函数
   - ✅ 通用工具函数
   - ✅ 用户认证和权限管理

2. **首页**
   - ✅ 统计数据展示（班级、作业、学生数量）
   - ✅ 当前班级信息
   - ✅ 快速操作入口
   - ✅ 最近作业列表
   - ✅ 班级切换功能

3. **班级管理**
   - ✅ 班级列表展示
   - ✅ 新建班级
   - ✅ 编辑班级信息
   - ✅ 删除班级（含数据清理）
   - ✅ 班级切换
   - ✅ 统计信息显示

4. **作业管理**
   - ✅ 作业列表展示
   - ✅ 新建作业
   - ✅ 编辑作业信息
   - ✅ 删除作业
   - ✅ 作业详情查看
   - ✅ 复杂题目结构支持（主题+子题）
   - ✅ 灵活评分标准设置

5. **学生管理**
   - ✅ 学生列表展示
   - ✅ 新建学生
   - ✅ 编辑学生信息
   - ✅ 删除学生
   - ✅ 学生信息统计

6. **成绩管理**
   - ✅ 成绩录入界面
   - ✅ 成绩查看和编辑
   - ✅ 成绩统计分析
   - ✅ 错题统计和分析
   - ✅ 数据导出功能（Excel格式）
   - ✅ 成绩排序和筛选

7. **数据存储与同步**
   - ✅ 本地数据存储
   - ✅ 数据兼容性处理
   - ✅ 完整的CRUD操作
   - ✅ 数据备份和恢复
   - ✅ Excel数据导入导出

8. **用户界面**
   - ✅ 响应式设计
   - ✅ 移动端优化
   - ✅ 用户体验优化
   - ✅ 统一的视觉风格

### 待优化功能

1. **性能优化**
   - 大数据量处理优化
   - 页面加载速度提升
   - 内存使用优化

2. **功能扩展**
   - 云端数据同步
   - 多用户协作
   - 数据分析图表
   - 家长端功能

3. **用户体验**
   - 操作引导和帮助
   - 快捷操作优化
   - 批量操作功能

## 项目结构

```
miniprogram/
├── app.js                    # 小程序入口文件
├── app.json                  # 小程序配置文件
├── app.wxss                  # 全局样式文件
├── sitemap.json              # 站点地图配置
├── project.config.json       # 项目配置文件
├── project.private.config.json # 私有配置文件
├── pages/                    # 页面文件夹
│   ├── index/                # 首页
│   ├── classes/              # 班级管理
│   ├── assignments/          # 作业管理
│   ├── assignment-detail/    # 作业详情
│   ├── assignment-edit/      # 作业编辑
│   ├── students/             # 学生管理
│   ├── score-entry/          # 成绩录入
│   ├── score-view/           # 成绩查看
│   ├── student-scores/       # 学生成绩
│   ├── statistics/           # 统计页面
│   └── user-info/            # 用户信息
├── utils/                    # 工具函数
│   ├── storage.js            # 数据存储工具
│   ├── util.js               # 通用工具函数
│   ├── auth.js               # 用户认证
│   ├── data-sync.js          # 数据同步
│   ├── excel-export.js       # Excel导出
│   └── markdown-parser.js    # Markdown解析
└── images/                   # 图片资源
    ├── assignment.png        # 作业图标
    ├── assignment-active.png # 作业图标（激活）
    ├── class.png             # 班级图标
    ├── class-active.png      # 班级图标（激活）
    ├── home.png              # 首页图标
    ├── home-active.png       # 首页图标（激活）
    ├── statistics.png        # 统计图标
    ├── statistics-active.png # 统计图标（激活）
    ├── student.png           # 学生图标
    ├── student-active.png    # 学生图标（激活）
    ├── user.png              # 用户图标
    └── user-active.png       # 用户图标（激活）
```

## 数据结构

### 班级 (Class)
```javascript
{
  id: string,           // 班级ID
  name: string,         // 班级名称
  description: string,  // 班级描述
  createdAt: string,    // 创建时间
  updatedAt: string     // 更新时间
}
```

### 作业 (Assignment)
```javascript
{
  id: string,              // 作业ID
  classId: string,         // 所属班级ID
  name: string,            // 作业名称
  type: string,            // 作业类型
  questionCount: number,   // 题目数量
  hasSubQuestions: boolean,// 是否有子题
  subQuestionCounts: array,// 子题数量
  scoringOptions: object,  // 评分选项
  createdAt: string,       // 创建时间
  updatedAt: string        // 更新时间
}
```

### 学生 (Student)
```javascript
{
  id: string,           // 学生ID
  classId: string,      // 所属班级ID
  name: string,         // 学生姓名
  studentNumber: string,// 学号
  createdAt: string,    // 创建时间
  updatedAt: string     // 更新时间
}
```

### 成绩 (Score)
```javascript
{
  id: string,           // 成绩ID
  assignmentId: string, // 作业ID
  studentId: string,    // 学生ID
  scores: object,       // 分数详情
  totalScore: number,   // 总分
  createdAt: string,    // 创建时间
  updatedAt: string     // 更新时间
}
```

## 开发说明

### 环境要求
- **微信开发者工具** (最新版本)
- **微信小程序开发账号** (个人或企业)
- **Node.js** (可选，用于本地工具)

### 开发环境配置

1. **下载微信开发者工具**
   - 访问 [微信开发者工具官网](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
   - 下载并安装最新版本

2. **获取小程序AppID**
   - 登录 [微信公众平台](https://mp.weixin.qq.com/)
   - 注册小程序账号或使用测试号
   - 在设置 → 开发设置中获取AppID

3. **项目导入**
   - 打开微信开发者工具
   - 选择"导入项目"
   - 选择 `miniprogram` 文件夹
   - 填入AppID（测试可使用测试号）

### 开发步骤
1. 使用微信开发者工具打开项目
2. 配置小程序AppID
3. 预览和调试
4. 真机测试
5. 代码审核和发布

### 注意事项
1. **数据存储**：使用微信小程序本地存储，单个key最大1MB，总容量最大10MB
2. **云开发**：后续可考虑接入微信云开发实现数据同步和备份
3. **图标资源**：已包含完整的tabBar图标资源
4. **兼容性**：支持微信版本6.6.3及以上
5. **权限**：无需特殊权限，仅使用基础API

## 部署指南

### 测试部署

1. **开发者工具预览**
   ```
   1. 在微信开发者工具中点击"预览"
   2. 扫描二维码在手机微信中打开
   3. 进行功能测试和界面检查
   ```

2. **真机调试**
   ```
   1. 点击"真机调试"
   2. 扫描二维码连接手机
   3. 在手机上进行实时调试
   ```

### 正式发布

#### 1. 代码准备
- 确保所有功能正常运行
- 清理调试代码和console.log语句
- 检查代码规范和注释
- 更新版本号

#### 2. 上传代码
```bash
# 在微信开发者工具中
1. 点击工具栏"上传"按钮
2. 填写版本号和项目备注
3. 确认上传
```

#### 3. 提交审核
1. **登录微信公众平台**
   - 访问 [微信公众平台](https://mp.weixin.qq.com/)
   - 进入小程序管理后台

2. **版本管理**
   - 进入"版本管理"页面
   - 找到刚上传的开发版本
   - 点击"提交审核"

3. **填写审核信息**
   - 选择功能页面和类目
   - 填写版本描述
   - 上传测试账号（如需要）
   - 提交审核申请

#### 4. 发布上线
- 审核通过后，在"版本管理"中点击"发布"
- 确认发布信息
- 正式发布到线上

### 发布注意事项

1. **小程序类目**
   - 选择"教育 → 在线教育"类目
   - 确保功能与类目匹配

2. **审核要求**
   - 确保所有功能可正常使用
   - 提供完整的使用流程
   - 避免使用敏感词汇
   - 遵守微信小程序运营规范

3. **版本管理**
   - 建议使用语义化版本号（如1.0.0）
   - 保留重要版本的代码备份
   - 记录每个版本的更新内容

4. **用户隐私**
   - 如收集用户信息，需添加隐私政策
   - 遵守数据保护相关法规

### 更新发布流程

```bash
# 日常更新流程
1. 开发新功能 → 本地测试
2. 上传代码 → 开发版测试
3. 提交审核 → 等待审核结果
4. 审核通过 → 发布上线
5. 线上验证 → 监控反馈
```

## 使用说明

### 快速开始

1. **创建班级**
   - 打开小程序，进入"班级"页面
   - 点击"新建班级"
   - 填写班级名称和描述

2. **添加学生**
   - 在班级页面选择目标班级
   - 进入"学生"页面
   - 添加学生信息

3. **创建作业**
   - 进入"作业"页面
   - 点击"新建作业"
   - 设置作业参数和评分标准

4. **录入成绩**
   - 选择作业和学生
   - 录入各题得分
   - 系统自动计算总分

### 数据管理

- **本地存储**：数据保存在设备本地，卸载应用会丢失数据
- **数据导出**：支持成绩数据导出为Excel格式
- **数据备份**：建议定期导出重要数据进行备份

## 更新日志

### v2.0.0 (当前版本)
- ✅ 完整的作业管理系统
- ✅ 学生管理功能
- ✅ 成绩录入和查看功能
- ✅ 数据导出功能（Excel）
- ✅ 错题统计和分析
- ✅ 用户界面优化
- ✅ 性能优化和代码清理
- ✅ 完善的部署指南

### v1.5.0 (功能完善版)
- ✅ 作业详情和编辑功能
- ✅ 成绩录入界面
- ✅ 数据同步功能
- ✅ 用户认证系统
- ✅ Excel导入导出功能

### v1.0.0 (基础版本)
- ✅ 创建基础项目结构
- ✅ 实现首页功能
- ✅ 实现班级管理功能
- ✅ 完成数据存储迁移
- ✅ 底部导航和基础UI

### 未来规划 (v3.0.0)
- 🔄 云端数据同步
- 🔄 多用户协作功能
- 🔄 数据分析图表
- 🔄 家长端小程序
- 🔄 AI辅助批改功能

## 分享说明与限制

- 分享载荷：分享路径携带 `payload`，包含学生信息、成绩概览、作业列表与错题概要。若过长将自动部分截断。
- 本地存储隔离：他人打开分享链接不会读取你的本地数据。链接含 `payload` 时可直接预览但不会落库。
- 文本分享：复制文本包含完整错题与作业信息；超长自动压缩为摘要并附带详情链接。
- 图片分享：根据内容动态扩展高度（最大约 3600 像素）；超出设备/画布限制时在图片底部提示“内容已截断显示”。
- 兼容限制：`payload` 建议最大长度 ≤ 1800（URL编码后）；超过时内容将逐步截断并在标题中标注。
- 建议用法：同学或家长查看建议使用图片；需要可复制的详细错题建议使用文本+链接。
- 后续计划：接入云端同步 `/sync/upload`、`/sync/download`，支持分享数据落库与多端查看。